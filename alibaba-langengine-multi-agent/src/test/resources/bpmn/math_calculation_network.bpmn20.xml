<?xml version="1.0" encoding="UTF-8"?>

<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:smart="http://smartengine.org/schema/process">
    <process  id="math_calculation_network" isExecutable="true" version="1">
        <startEvent id="start" name="开始">
            <extensionElements>
                <smart:properties>
                    <smart:value name="inputParameters" value="[{}]"/>
                    <smart:value name="templateType" value="start"/>
                </smart:properties>
            </extensionElements>
        </startEvent>
        <endEvent id="end" name="结束">
            <extensionElements>
                <smart:properties>
                    <smart:value name="finalOutputParameters" value="[{&quot;message&quot;:&quot;ok&quot;}]"/>
                    <smart:value name="templateType" value="end"/>
                </smart:properties>
            </extensionElements>
        </endEvent>
        <serviceTask id="formulaDecomposition" name="公式分解" smart:class="com.alibaba.langengine.multiagent.delegation.ExecutionAgentDelegation">
            <extensionElements>
                <smart:properties>
                    <smart:value name="agentStrategy" value="network"/>
                    <smart:value name="maxRound" value="16"/>
<!--                    <smart:value name="routeAgent" value="group_manager" />-->
                    <smart:value name="llm" value="gpt-4o"/>
                    <smart:value name="temperature" value="0.5"/>
                    <smart:value name="agentType" value="llm"/>
                    <smart:value name="agentRoles" value="addition,subtraction,multiplication,division" />
                    <smart:value name="systemPrompt" value="# 角色\n你是一位专门处理数学公式分解的智能助手，能够逐步解析和分解复杂的数学表达式。\n\n# 示例\n给定数学表达式：(10 + 2 * 3 - 4) / 2 \n\n## 分解步骤\n1. 2 * 3\n2. 10 + 第1步的结果\n3. 第2步结果 - 4\n4. 第3步 / 2\n\n# 注意事项\n- **不需要你的计算过程结果和最终结果，只需要分解步骤即可**\n\n# 风格\n- 采用简洁明了的语言风格，确保每个步骤易于理解。\n- 注重数学运算的准确性和步骤的连贯性。" />
                    <smart:value name="backstory" value="addition: 你只计算加法的步骤，且只返回加法的结果，不要有额外文字\nsubtraction: 你只计算减法的步骤，且只返回减法的结果，不要有额外文字\nmultiplication: =你只计算乘法的步骤，且只返回乘法的结果，不要有额外文字\ndivision: 你只计算除法的步骤，且只返回除法的结果，不要有额外文字" />
                </smart:properties>
            </extensionElements>
        </serviceTask>
        <serviceTask id="addition" name="加法" smart:class="com.alibaba.langengine.multiagent.delegation.ExecutionAgentDelegation">
            <extensionElements>
                <smart:properties>
                    <smart:value name="llm" value="gpt-4o"/>
                    <smart:value name="temperature" value="0.5"/>
                    <smart:value name="agentType" value="llm"/>
                    <smart:value name="agentRoles" value="formulaDecomposition,subtraction,multiplication,division" />
                    <smart:value name="systemPrompt" value="你只计算加法的步骤，且只返回加法的结果，不要有额外文字" />
                    <smart:value name="backstory" value="formulaDecomposition: # 角色\n你是一位专门处理数学公式分解的智能助手，能够逐步解析和分解复杂的数学表达式，引导后面的agent一步步仔细完成。\n\n# 示例\n给定数学表达式：(10 + 2 * 3 - 4) / 2 \n\n## 分解步骤\n1. 2 * 3\n2. 10 + 第1步的结果\n3. 第2步结果 - 4\n4. 第3步 / 2\n\n# 注意事项\n- **不需要你的计算过程结果和最终结果，只需要分解步骤即可**\n\n# 风格\n- 采用简洁明了的语言风格，确保每个步骤易于理解。\n- 注重数学运算的准确性和步骤的连贯性。\nsubtraction: 你只计算减法的步骤，且只返回减法的结果，不要有额外文字\nmultiplication: =你只计算乘法的步骤，且只返回乘法的结果，不要有额外文字\ndivision: 你只计算除法的步骤，且只返回除法的结果，不要有额外文字" />
                </smart:properties>
            </extensionElements>
        </serviceTask>
        <serviceTask id="subtraction" name="减法" smart:class="com.alibaba.langengine.multiagent.delegation.ExecutionAgentDelegation">
            <extensionElements>
                <smart:properties>
                    <smart:value name="llm" value="gpt-4o"/>
                    <smart:value name="temperature" value="0.5"/>
                    <smart:value name="agentType" value="llm"/>
                    <smart:value name="agentRoles" value="formulaDecomposition,addition,multiplication,division" />
                    <smart:value name="systemPrompt" value="你只计算减法的步骤，且只返回减法的结果，不要有额外文字" />
                    <smart:value name="backstory" value="formulaDecomposition: # 角色\n你是一位专门处理数学公式分解的智能助手，能够逐步解析和分解复杂的数学表达式，引导后面的agent一步步仔细完成。\n\n# 示例\n给定数学表达式：(10 + 2 * 3 - 4) / 2 \n\n## 分解步骤\n1. 2 * 3\n2. 10 + 第1步的结果\n3. 第2步结果 - 4\n4. 第3步 / 2\n\n# 注意事项\n- **不需要你的计算过程结果和最终结果，只需要分解步骤即可**\n\n# 风格\n- 采用简洁明了的语言风格，确保每个步骤易于理解。\n- 注重数学运算的准确性和步骤的连贯性。\naddition: 你只计算加法的步骤，且只返回加法的结果，不要有额外文字\ndivision: 你只计算除法的步骤，且只返回除法的结果，不要有额外文字" />
                </smart:properties>
            </extensionElements>
        </serviceTask>
        <serviceTask id="multiplication" name="乘法" smart:class="com.alibaba.langengine.multiagent.delegation.ExecutionAgentDelegation">
            <extensionElements>
                <smart:properties>
                    <smart:value name="llm" value="gpt-4o"/>
                    <smart:value name="temperature" value="0.5"/>
                    <smart:value name="agentType" value="llm"/>
                    <smart:value name="agentRoles" value="formulaDecomposition,addition,subtraction,division" />
                    <smart:value name="systemPrompt" value="你只计算乘法的步骤，且只返回乘法的结果，不要有额外文字" />
                    <smart:value name="backstory" value="formulaDecomposition: # 角色\n你是一位专门处理数学公式分解的智能助手，能够逐步解析和分解复杂的数学表达式，引导后面的agent一步步仔细完成。\n\n# 示例\n给定数学表达式：(10 + 2 * 3 - 4) / 2 \n\n## 分解步骤\n1. 2 * 3\n2. 10 + 第1步的结果\n3. 第2步结果 - 4\n4. 第3步 / 2\n\n# 注意事项\n- **不需要你的计算过程结果和最终结果，只需要分解步骤即可**\n\n# 风格\n- 采用简洁明了的语言风格，确保每个步骤易于理解。\n- 注重数学运算的准确性和步骤的连贯性。\naddition: 你只计算加法的步骤，且只返回加法的结果，不要有额外文字\nsubtraction: 你只计算减法的步骤，且只返回减法的结果，不要有额外文字\ndivision: 你只计算除法的步骤，且只返回除法的结果，不要有额外文字" />
                </smart:properties>
            </extensionElements>
        </serviceTask>
        <serviceTask id="division" name="除法" smart:class="com.alibaba.langengine.multiagent.delegation.ExecutionAgentDelegation">
            <extensionElements>
                <smart:properties>
                    <smart:value name="llm" value="gpt-4o"/>
                    <smart:value name="temperature" value="0.5"/>
                    <smart:value name="agentType" value="llm"/>
                    <smart:value name="agentRoles" value="formulaDecomposition,addition,subtraction,multiplication" />
                    <smart:value name="systemPrompt" value="你只计算除法的步骤，且只返回除法的结果，不要有额外文字" />
                    <smart:value name="backstory" value="formulaDecomposition: # 角色\n你是一位专门处理数学公式分解的智能助手，能够逐步解析和分解复杂的数学表达式，引导后面的agent一步步仔细完成。\n\n# 示例\n给定数学表达式：(10 + 2 * 3 - 4) / 2 \n\n## 分解步骤\n1. 2 * 3\n2. 10 + 第1步的结果\n3. 第2步结果 - 4\n4. 第3步 / 2\n\n# 注意事项\n- **不需要你的计算过程结果和最终结果，只需要分解步骤即可**\n\n# 风格\n- 采用简洁明了的语言风格，确保每个步骤易于理解。\n- 注重数学运算的准确性和步骤的连贯性。\naddition: 你只计算加法的步骤，且只返回加法的结果，不要有额外文字\nsubtraction: 你只计算减法的步骤，且只返回减法的结果，不要有额外文字" />
                </smart:properties>
            </extensionElements>
        </serviceTask>
        <sequenceFlow id="xy-edge__start-formulaDecomposition" sourceRef="start" targetRef="formulaDecomposition"/>
    </process>
</definitions>
